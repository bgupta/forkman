---

# Most uniq patterns should go first
# !!! ORDER IS IMPORTANT !!!
patterns:

  # Keep Original Sites
  www.habitat.sh: www.habitat.sh
  bldr.habitat.sh: bldr.habitat.sh
  forums.habitat.sh: forums.habitat.sh
  slack.habiat.sh: slack.habitat.sh

  # Keep Original GitHub Issues, PRs, Apps
  github.com/habitat-sh/habitat/issues: github.com/habitat-sh/habitat/issues
  github.com/habitat-sh/habitat/pull: github.com/habitat-sh/habitat/pull
  https://github.com/apps/habitat-builder: https://github.com/apps/habitat-builder

  # Currently don't touch bintray
  # https://api.bintray.com/content/habitat: https://api.bintray.com/content/habitat
  # https://api.bintray.com/packages/habitat: https://api.bintray.com/packages/habitat

  The Habitat Maintainers: The Biome Maintainers
  humans@habitat.sh: humans@biome.sh

  # Github Source
  habitat-sh/rust-zmq: habitat-sh/rust-zmq
  habitat-sh/ipc-channel: habitat-sh/ipc-channel
  habitat-sh/nitox: habitat-sh/nitox
  habitat-sh/core-plans: habitat-sh/core-plans

  # Temporary stick with mine repo
  # https://github.com/habitat-sh/habitat: https://github.com/jsirex/biome
  # https://raw.githubusercontent.com/habitat-sh/habitat/: https://raw.githubusercontent.com/jsirex/biome/
  # 'github.com:habitat-sh/habitat': 'github.com:jsirex/biome'
  # Use our new org!
  https://github.com/habitat-sh/habitat: https://github.com/biome-sh/biome
  https://raw.githubusercontent.com/habitat-sh/habitat/: https://raw.githubusercontent.com/biome-sh/biome/
  'github.com:habitat-sh/habitat': 'github.com:biome-sh/biome'

  # Remove chef licenses checks from OSS Version
  'license::accept_license(ui)?;': ''
  'if license_exists() ': 'if true '
  'license::check_for_license_acceptance_and_prompt(ui)?;': ''

  # Translate constants
  pkg_origin=core: pkg_origin=biome
  pkg_name=hab: pkg_name=bio
  pkg_path_for hab: pkg_path_for bio

  habirails: biorails
  core/hab: biome/bio
  core-hab: biome-bio
  core/hab hab: biome/bio bio
  hab --version: bio --version
  hab.exe: bio.exe

  ':habicat:': ':habicat:'
  ':hab:': ':bio:'

  # Docker Studios (biome org has already taken. use biomesh)
  'const DOCKER_IMAGE: &str = "habitat/default-studio"': 'const DOCKER_IMAGE: &str = "biomesh/default-studio"'
  'const DOCKER_WINDOWS_IMAGE: &str = "habitat-docker-registry.bintray.io/win-studio"': 'const DOCKER_WINDOWS_IMAGE: &str = "biomesh/win-studio"'
  habitat/devshell: biomesh/devshell

  # Make plans use habitat
  habitat/plan.sh: habitat/plan.sh
  habitat/x86_64-darwin: habitat/x86_64-darwin
  habitat/plan.ps1: habitat/plan.ps1
  PLAN_CONTEXT/habitat: PLAN_CONTEXT/habitat
  PLAN_CONTEXT\habitat: PLAN_CONTEXT\\habitat
  rootfs/hab: rootfs/hab
  FS_ROOT/hab: FS_ROOT/hab
  pkg_svc_user=hab: pkg_svc_user=hab
  'pkg_svc_user="hab"': 'pkg_svc_user="hab"'

  # Preserve path joining
  '            .join("hab")': '            .join("hab")'

  'Path::new(&*FS_ROOT_PATH).join("hab")': 'Path::new(&*FS_ROOT_PATH).join("hab")'
  'PathBuf::from(&*FS_ROOT_PATH).join("hab")': 'PathBuf::from(&*FS_ROOT_PATH).join("hab")'
  'rootfs.join("hab")': 'rootfs.join("hab")'
  'HAB_ROOT_PATH:=/hab': 'HAB_ROOT_PATH:=/hab'
  'pub const ROOT_PATH: &str = "hab";': 'pub const ROOT_PATH: &str = "hab";'

  # After replacement all occurances hab_pkgs_path will be bio_pkgs_path
  'tar_builder.append_dir_all("hab", hab_pkgs_path);': 'tar_builder.append_dir_all("hab", bio_pkgs_path);'

  # Supervisor compatibility habitat <-> biome
  'const HABITAT_SUBJECT: &str = "habitat";': 'const HABITAT_SUBJECT: &str = "habitat";'
  'let topic = "habitat".to_string();': 'let topic = "habitat".to_string();'


  # Add hab user into studio
  'echo "${run_user}:x:42:42:root:/:/bin/sh" >> "$HAB_STUDIO_ROOT"/etc/passwd': |
    echo "${run_user}:x:43:43:root:/:/bin/sh" >> "$HAB_STUDIO_ROOT"/etc/passwd
      echo "hab:x:42:42:root:/:/bin/sh" >> "$HAB_STUDIO_ROOT"/etc/passwd

  # Add hab group into studio
  'echo "${run_group}:x:42:${run_user}" >> "$HAB_STUDIO_ROOT"/etc/group': |
    echo "${run_group}:x:43:${run_user}" >> "$HAB_STUDIO_ROOT"/etc/group
      echo "hab:x:42:hab" >> "$HAB_STUDIO_ROOT"/etc/group

  # Add hab user into docker studio:
  'hab:x:42:42:root:/:/bin/sh': |
    bio:x:43:43:root:/:/bin/sh
    hab:x:42:42:root:/:/bin/sh

  # Add hab group into docker studio:
  'hab:x:42:hab': |
    bio:x:43:bio
    hab:x:42:hab

  # tools / sup network
  'RUN useradd --user-group hab': |
    RUN useradd --user-group hab
    RUN useradd --user-group bio


  Habitat: Biome
  habitat: biome
  habiat: biome
  Habiat: Biome

  # Make some biome path compatible
  hab/bin: hab/bin
  hab/etc: hab/etc
  hab/launcher: hab/launcher
  hab/sup: hab/sup
  hab/svc: hab/svc
  hab/pkgs: hab/pkgs
  hab/cache: hab/cache
  hab/studios: hab/studios

  # Also windows
  hab\bin: hab\\bin
  hab\etc: hab\\etc
  hab\launcher: hab\\launcher
  hab\sup: hab\\sup
  hab\svc: hab\\svc
  hab\pkgs: hab\\pkgs
  hab\cache: hab\\cache
  hab\studios: hab\\studios

  # Double slash in quotes translate too
  hab\\bin: hab\\\\bin
  hab\\etc: hab\\\\etc
  hab\\launcher: hab\\\\launcher
  hab\\sup: hab\\\\sup
  hab\\svc: hab\\\\svc
  hab\\pkgs: hab\\\\pkgs
  hab\\cache: hab\\\\cache
  hab\\studios: hab\\\\studios

  hab/hab: bio/bio
  ' hab ': ' bio '

  # Translate all habs beacause
  # Replacing hab -> bio is danger (word `unreachable` will be `unreacbiole` )
  hab/: bio/
  hab\: bio\\
  hab\\: bio\\\\

  # Assigments
  =hab: =bio
  hab=: bio=
  '= hab': '= bio'
  'hab =': 'bio ='
  '= "hab"': '= "bio"'

  # Relative path
  ../hab: ../bio

  # Variables
  _hab: _bio
  hab_: bio_
  -hab: -bio
  hab-: bio-
  '&hab': '&bio'
  '$hab': '$bio'
  '${hab}': '${bio}'

  /hab: /bio
  bin/hab: bin/bio
  'use hab': 'use bio'
  'hab::': 'bio::'

  # String occurances
  '"hab"': '"bio"'
  "'hab'": "'bio'"
  ' hab': ' bio'
  # Not always works somewhy?
  '`hab': '`bio'


  'hab ': 'bio '

  'hab:': 'bio:'
  hab\: bio\\
  \hab: \\bio
  ':hab': ':bio'
  '[hab]': '[bio]'
  .hab: .bio

# Delete some files which safe to ignore
deletes:
  # We're not going to support public site now
  - www

  # Silence mentions
  - .mailmap
  - .mention-bot
  - CODEOWNERS

  # Development will go in upstream
  - README.md
  - CHANGELOG.md
  - CONTRIBUTING.md
  - MAINTAINERS.md
  - RELEASE.md
  - .github

  # Remove stock travis and other ci-s
  - .travis.yml
  - .buildkite
  - .expeditor

# Excludes from patching contents
excludes:
  - components/core/tests/fixtures/unhappyhumans-possums-8.1.4-20160427165340-x86_64-linux.hart
  - www/source/blog/media/2018-08-18-lift-and-shift-bio/run_tar_ubuntu_vm.png
  - www/source/downloads/bio.gz
  - www/source/downloads/bio.zip
  - www/source/images/infographics/biome-builder-architecture.png
  - www/source/images/homepage/architecture-diagram.png
